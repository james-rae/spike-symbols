{"version":3,"file":"styleUtils-Cj5AxdUy.js","sources":["../../node_modules/@arcgis/core/symbols/support/styleCache.js","../../node_modules/@arcgis/core/symbols/support/styleUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nconst e=new Map;export{e as cachedStyles};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../request.js\";import t from\"../../core/Error.js\";import has from\"../../core/has.js\";import{throwIfAbortError as r}from\"../../core/promiseUtils.js\";import{normalize as o,removeFile as s}from\"../../core/urlUtils.js\";import n from\"../../portal/Portal.js\";import l from\"../../portal/PortalQueryParams.js\";import{cachedStyles as a}from\"./styleCache.js\";async function f(e,t){try{return{data:(await p(e,t)).data,baseUrl:s(e),styleUrl:e}}catch(o){return r(o),null}}function u(e,t,r){const o=null!=t.portal?t.portal:n.getDefault();let s;const l=`${o.url} - ${o.user?.username} - ${e}`,f=a.get(l);if(f)return f;const u=c(e,o,r).then((e=>(s=e,e.fetchData()))).then((t=>({data:t,baseUrl:s.itemUrl??\"\",styleName:e})));return a.set(l,u),u}function c(e,r,o){return r.load(o).then((()=>{const t=new l({disableExtraQuery:!0,query:`owner:${d} AND type:${b} AND typekeywords:\"${e}\"`});return r.queryItems(t,o)})).then((({results:r})=>{let s=null;const n=e.toLowerCase();if(r&&Array.isArray(r))for(const e of r){const t=e.typeKeywords?.some((e=>e.toLowerCase()===n));if(t&&e.type===b&&e.owner===d){s=e;break}}if(!s)throw new t(\"symbolstyleutils:style-not-found\",`The style '${e}' could not be found`,{styleName:e});return s.load(o)}))}function i(e,r,o){return null!=e?.styleUrl?f(e.styleUrl,o):null!=e?.styleName?u(e.styleName,r,o):Promise.reject(new t(\"symbolstyleutils:style-url-and-name-missing\",\"Either styleUrl or styleName is required to resolve a style\"))}function m(e){return null===e||\"CIMSymbolReference\"===e.type?e:{type:\"CIMSymbolReference\",symbol:e}}function y(e,t,r=[\"gltf\"]){if(\"cimRef\"===t)return encodeURI(e.cimRef);if(e.formatInfos&&!has(\"enable-feature:force-wosr\"))for(const o of r){const t=e.formatInfos.find((e=>e.type===o));if(t)return t.href}return encodeURI(e.webRef)}function p(t,r){const s={responseType:\"json\",query:{f:\"json\"},...r};return e(o(t),s)}const d=\"esri_en\",b=\"Style\",h=\"https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json\";export{h as Style2DUrlTemplate,i as fetchStyle,m as makeCIMSymbolRef,p as requestJSON,y as symbolUrlFromStyleItem};\n"],"names":["e","f","t","p","s","o","r","u","n","_a","a","c","l","d","b","i","m","y","has","h"],"mappings":"4FAIA,MAAMA,EAAE,IAAI,ICAkW,eAAeC,EAAED,EAAEE,EAAE,CAAC,GAAG,CAAC,MAAM,CAAC,MAAM,MAAMC,EAAEH,EAAEE,CAAC,GAAG,KAAK,QAAQE,EAAEJ,CAAC,EAAE,SAASA,CAAC,CAAC,OAAOK,EAAE,CAAC,OAAOC,EAAED,CAAC,EAAE,IAAI,CAAC,CAAC,SAASE,EAAEP,EAAEE,EAAEI,EAAE,OAAC,MAAMD,EAAQH,EAAE,QAAR,KAAeA,EAAE,OAAOM,EAAE,WAAU,EAAG,IAAIJ,EAAE,MAAM,EAAE,GAAGC,EAAE,GAAG,OAAMI,EAAAJ,EAAE,OAAF,YAAAI,EAAQ,QAAQ,MAAMT,CAAC,GAAGC,EAAES,EAAE,IAAI,CAAC,EAAE,GAAGT,EAAE,OAAOA,EAAE,MAAMM,EAAEI,EAAEX,EAAEK,EAAEC,CAAC,EAAE,KAAMN,IAAII,EAAEJ,EAAEA,EAAE,UAAW,EAAG,EAAC,KAAME,IAAI,CAAC,KAAKA,EAAE,QAAQE,EAAE,SAAS,GAAG,UAAUJ,CAAC,IAAK,OAAOU,EAAE,IAAI,EAAEH,CAAC,EAAEA,CAAC,CAAC,SAASI,EAAEX,EAAEM,EAAED,EAAE,CAAC,OAAOC,EAAE,KAAKD,CAAC,EAAE,KAAM,IAAI,CAAC,MAAMH,EAAE,IAAIU,EAAE,CAAC,kBAAkB,GAAG,MAAM,SAASC,CAAC,aAAaC,CAAC,sBAAsBd,CAAC,GAAG,CAAC,EAAE,OAAOM,EAAE,WAAWJ,EAAEG,CAAC,CAAC,CAAC,EAAG,KAAM,CAAC,CAAC,QAAQC,CAAC,IAAI,OAAC,IAAIF,EAAE,KAAK,MAAMI,EAAER,EAAE,YAAW,EAAG,GAAGM,GAAG,MAAM,QAAQA,CAAC,GAAE,UAAUN,KAAKM,EAA0D,KAA/CG,EAAAT,EAAE,eAAF,YAAAS,EAAgB,KAAMT,GAAGA,EAAE,YAAa,IAAGQ,KAAUR,EAAE,OAAOc,GAAGd,EAAE,QAAQa,EAAE,CAACT,EAAEJ,EAAE,KAAK,EAAE,GAAG,CAACI,EAAE,MAAM,IAAIF,EAAE,mCAAmC,cAAcF,CAAC,uBAAuB,CAAC,UAAUA,CAAC,CAAC,EAAE,OAAOI,EAAE,KAAKC,CAAC,CAAC,CAAG,CAAA,CAAC,SAASU,EAAEf,EAAEM,EAAED,EAAE,CAAC,OAAaL,GAAA,YAAAA,EAAG,WAAT,KAAkBC,EAAED,EAAE,SAASK,CAAC,GAAQL,GAAA,YAAAA,EAAG,YAAT,KAAmBO,EAAEP,EAAE,UAAUM,EAAED,CAAC,EAAE,QAAQ,OAAO,IAAIH,EAAE,8CAA8C,6DAA6D,CAAC,CAAC,CAAC,SAASc,EAAEhB,EAAE,CAAC,OAAcA,IAAP,MAAiCA,EAAE,OAAzB,qBAA8BA,EAAE,CAAC,KAAK,qBAAqB,OAAOA,CAAC,CAAC,CAAC,SAASiB,EAAEjB,EAAEE,EAAEI,EAAE,CAAC,MAAM,EAAE,CAAC,GAAcJ,IAAX,SAAa,OAAO,UAAUF,EAAE,MAAM,EAAE,GAAGA,EAAE,aAAa,CAACkB,EAAI,2BAA2B,EAAE,UAAUb,KAAKC,EAAE,CAAC,MAAMJ,EAAEF,EAAE,YAAY,KAAMA,GAAGA,EAAE,OAAOK,CAAG,EAAC,GAAGH,EAAE,OAAOA,EAAE,IAAI,CAAC,OAAO,UAAUF,EAAE,MAAM,CAAC,CAAC,SAASG,EAAE,EAAEG,EAAE,CAAC,MAAMF,EAAE,CAAC,aAAa,OAAO,MAAM,CAAC,EAAE,MAAM,EAAE,GAAGE,CAAC,EAAE,OAAON,EAAEK,EAAE,CAAC,EAAED,CAAC,CAAC,CAAM,MAACS,EAAE,UAAUC,EAAE,QAAQK,EAAE","x_google_ignoreList":[0,1]}