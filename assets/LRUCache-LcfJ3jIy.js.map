{"version":3,"file":"LRUCache-LcfJ3jIy.js","sources":["../../node_modules/@arcgis/core/core/MemCache.js","../../node_modules/@arcgis/core/core/LRUCache.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport t from\"./PooledArray.js\";const e=-3,s=e-1;var i;!function(t){t[t.ALL=0]=\"ALL\",t[t.SOME=1]=\"SOME\"}(i||(i={}));class r{constructor(t,e,s){this.name=t,this._storage=e,this.id=o+++\":\",this.size=0,this.maxSize=-1,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),s&&(this._storage.registerRemoveFunc(this.id,s),this._removeFunc=!0)}destroy(){this._storage.clear(this),this._removeFunc&&this._storage.deregisterRemoveFunc(this.id),this._storage.deregister(this),this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get storageSize(){return this._storage.size}getSize(t){return this._storage.getSize(this,t)}resetHitRate(){this._hit=this._miss=0}put(t,e,s,i=0){this._storage.put(this,t,e,s,i)}pop(t){const e=this._storage.pop(this,t);return void 0===e?++this._miss:++this._hit,e}get(t){const e=this._storage.get(this,t);return void 0===e?++this._miss:++this._hit,e}peek(t){return this._storage.peek(this,t)}updateSize(t,e,s){this._storage.updateSize(this,t,e,s)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class h{get size(){return this._size}constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new t,this._users=new t}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(t){this._users.push(t)}deregister(t){this._users.removeUnordered(t)}registerRemoveFunc(t,e){this._removeFuncs.push([t,e])}deregisterRemoveFunc(t){this._removeFuncs.filterInPlace((e=>e[0]!==t))}get maxSize(){return this._maxSize}set maxSize(t){this._maxSize=Math.max(t,-1),this._checkSize()}getSize(t,e){const s=this._db.get(t.id+e);return s?.size??0}put(t,r,h,o,_){r=t.id+r;const a=this._db.get(r);if(a&&(this._size-=a.size,t.size-=a.size,this._db.delete(r),a.entry!==h&&this._notifyRemove(r,a.entry,a.size,i.ALL)),o>this._maxSize)return void this._notifyRemove(r,h,o,i.ALL);if(void 0===h)return void console.warn(\"Refusing to cache undefined entry \");if(!o||o<0)return console.warn(`Refusing to cache entry with size ${o} for key ${r}`),void this._notifyRemove(r,h,0,i.ALL);const c=1+Math.max(_,s)-e;this._db.set(r,new n(h,o,c)),this._size+=o,t.size+=o,this._checkSize()}updateSize(t,e,s,r){e=t.id+e;const h=this._db.get(e);if(h&&h.entry===s){for(this._size-=h.size,t.size-=h.size;r>this._maxSize;){const t=this._notifyRemove(e,s,r,i.SOME);if(!(null!=t&&t>0))return void this._db.delete(e);r=t}h.size=r,this._size+=r,t.size+=r,this._checkSize()}}pop(t,e){e=t.id+e;const s=this._db.get(e);if(s)return this._size-=s.size,t.size-=s.size,this._db.delete(e),++this._hit,s.entry;++this._miss}get(t,e){e=t.id+e;const s=this._db.get(e);if(void 0!==s)return this._db.delete(e),s.lives=s.lifetime,this._db.set(e,s),++this._hit,s.entry;++this._miss}peek(t,e){const s=this._db.get(t.id+e);return s?++this._hit:++this._miss,s?.entry}get performanceInfo(){const t={Size:Math.round(this._size/1048576)+\"/\"+Math.round(this._maxSize/1048576)+\"MB\",\"Hit rate\":Math.round(100*this._getHitRate())+\"%\",Entries:this._db.size.toString()},s={},i=new Array;this._db.forEach(((t,e)=>{const r=t.lifetime;i[r]=(i[r]||0)+t.size,this._users.forAll((i=>{const{id:r,name:h}=i;if(e.startsWith(r)){const e=s[h]||0;s[h]=e+t.size}}))}));const r={};this._users.forAll((t=>{const e=t.name;if(\"hitRate\"in t&&\"number\"==typeof t.hitRate&&!isNaN(t.hitRate)&&t.hitRate>0){const i=s[e]||0;s[e]=i,r[e]=Math.round(100*t.hitRate)+\"%\"}else r[e]=\"0%\"}));const h=Object.keys(s);h.sort(((t,e)=>s[e]-s[t])),h.forEach((e=>t[e]=Math.round(s[e]/2**20)+\"MB / \"+r[e]));for(let o=i.length-1;o>=0;--o){const s=i[o];s&&(t[\"Priority \"+(o+e-1)]=Math.round(s/this._size*100)+\"%\")}return t}resetStats(){this._hit=this._miss=0,this._users.forAll((t=>t.resetHitRate()))}clear(t){const e=t.id;this._db.forEach(((t,s)=>{s.startsWith(e)&&(this._size-=t.size,this._db.delete(s),this._notifyRemove(s,t.entry,t.size,i.ALL))})),t.size=0}clearAll(){this._db.forEach(((t,e)=>this._notifyRemove(e,t.entry,t.size,i.ALL))),this._users.forAll((t=>t.size=0)),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(t,e,s,i){let r;return this._removeFuncs.some((h=>{if(t.startsWith(h[0])){const t=h[1](e,i,s);return\"number\"==typeof t&&(r=t),!0}return!1})),r}_checkSize(){this._users.forAll((t=>this._checkSizeLimits(t))),this._checkSizeLimits()}_checkSizeLimits(t){const e=t??this;if(e.maxSize<0||e.size<=e.maxSize)return;const s=t?.id;let i=!0;for(;i;){i=!1;for(const[r,h]of this._db)if(0===h.lifetime&&(!s||r.startsWith(s))){if(this._purgeItem(r,h,t),e.size<=.9*e.maxSize)return;i||=this._db.has(r)}}for(const[r,h]of this._db)if((!s||r.startsWith(s))&&(this._purgeItem(r,h,t),e.size<=.9*e.maxSize))return}_purgeItem(t,e,s=this._users.find((e=>t.startsWith(e.id)))){if(this._db.delete(t),e.lives<=1){this._size-=e.size,s&&(s.size-=e.size);const r=this._notifyRemove(t,e.entry,e.size,i.SOME);null!=r&&r>0&&(this._size+=r,s&&(s.size+=r),e.lives=e.lifetime,e.size=r,this._db.set(t,e))}else--e.lives,this._db.set(t,e)}}let o=0;class n{constructor(t,e,s){this.entry=t,this.size=e,this.lifetime=s,this.lives=s}}export{r as MemCache,h as MemCacheStorage,e as MinPriority,s as NoPriority,i as RemoveMode};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{MemCacheStorage as t}from\"./MemCache.js\";class e{constructor(e,s){this._storage=new t,this.id=\"\",this.name=\"\",this.size=0,this._storage.maxSize=e,this._storage.register(this),s&&this._storage.registerRemoveFunc(\"\",s)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(t,e,s=1){this._storage.put(this,t,e,s,1)}pop(t){return this._storage.pop(this,t)}get(t){return this._storage.get(this,t)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(t){this._storage.maxSize=t}resetHitRate(){}}export{e as LRUCache};\n"],"names":["e","s","i","t","h","r","o","_","a","c","n"],"mappings":"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","x_google_ignoreList":[0,1]}